{% extends 'base.html' %}

{% block localCssLink %}
    {% load static %}
    <link href="{% static 'css/manager.css' %}" rel="stylesheet" type="text/css">
{% endblock %}

{% block name %}
    Личный кабинет
{% endblock %}

{% block content %}
    <div class="root">
        <div class="main_container">
            <div class="upper-content-wrapper">
                <div class="name">
                    Кошелёк
                </div>
                <div class="wallet">
                    {% for currency in balance %}
                    <div class="content">
                        {{ currency.currency_id }} : {{ currency.amount }}
                    </div>
                    {% endfor %}
                </div>
                <div class="content" id="total-amount">
                    Всего: {{ total }}
                </div>
            </div>
            <div class="down-content-wrapper">
                <div class="name">
                    Добавить операцию
                </div>
                <form action="" method="POST" class="form_add_operation">
                    {% csrf_token %}
                    <div class="content">
                        {{ form.operation_type }}
                    </div>
                    <div class="content">
                        {{ form.currency }}
                    </div>
                    <div class="content">
                        {{ form.amount }}
                    </div>
                    <div class="content">
                        {{ form.datetime }}
                    </div>
                    <div class="content" id="category">
                        {{ form.category }}
                    </div>
                    <div class="content" id="new_category">
                        {{ form.new_category }}
                    </div>
                    <div id="swap-category">Добавить категорию</div>
                    <div class="content">
                        {{ form.description }}
                    </div>
                    <div class="form_button">
                        <input type="submit" value="Добавить операцию" id="add_operation">
                    </div>
                </form>
            </div>
        </div>
        <div class="main_container">
            <div class="upper-content-wrapper">
                <div class="name">
                    Последние операции
                </div>
                <div class="filters-wrapper">
                    <form method="GET">
                        <input  class="filter" id="start-export-date" type="date" name="start-date" placeholder="Выберите дату" required>
                        <input  class="filter" id="end-export-date" type="date" name="end-date" placeholder="Выберите дату" required>
                        <button class="filter" type="submit" id="add_filter">Отправить</button>
                    </form>
                </div>
                <div class="operations_content">
                    {% regroup operations by datetime as operations_list %}
                    {% for operation in operations_list %}
                        <div class="date_grouper">{{ operation.grouper }}</div>
                        {% for one_operation in operation.list %}
                            <div class="content operation-details">
                                {% if one_operation.operation_type == '+' %}
                                    <div class="type_image" style="background-image: url({% static 'plus-sign.png' %}"></div>
                                {% else %}
                                    <div class="type_image" style="background-image: url({% static 'minus-sign.png' %}"></div>
                                {% endif %}
                                <div class="operation-wrapper">
                                    <div class="category-label"> {{ one_operation.category }}</div>
                                    <div class="amount-wrapper">
                                        <div class="amount-label">{{ one_operation.amount }}</div>
                                        <div class="currency-label">{{ one_operation.currency }}</div>
                                    </div>
                                </div>
                            </div>
                        {% endfor %}
                    {% endfor %}
                </div>
            </div>
            <div class="down-content-wrapper">
                <div class="name">
                    Текущий курс валют
                </div>
                <div class="operations_content">
                    <div class="content">
                        {{ currency1 }} : {{ amount }}
                    </div>
                    <div class="content">
                        {{ currency2 }} : {{ amount }}
                    </div>
                    <div class="content">
                        {{ currency3 }} : {{ amount }}
                    </div>
                </div>
            </div>
        </div>
        <script src="{% static 'dropdown.js' %}"></script>
    </div>
{% endblock %}

